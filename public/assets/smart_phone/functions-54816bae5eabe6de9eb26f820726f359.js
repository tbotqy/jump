function facebook(t,e,a){var n,r=t.getElementsByTagName(e)[0];t.getElementById(a)||((n=t.createElement(e)).id=a,n.src="//connect.facebook.net/ja_JP/all.js#xfbml=1&appId=258025897640441",r.parentNode.insertBefore(n,r))}function updatePageTitleForTimeline(t,e){var a="",n="",r=convertDateToJapanese(t),i=getTimelineOwnerName(),d="TwitJump";switch(e){case"tweets":n=" "+i+" \u3055\u3093\u306e\u30c4\u30a4\u30fc\u30c8";break;case"home_timeline":n=" "+i+" \u3055\u3093\u306e\u30db\u30fc\u30e0\u30bf\u30a4\u30e0\u30e9\u30a4\u30f3";break;case"public_timeline":n="\u30d1\u30d6\u30ea\u30c3\u30af\u30bf\u30a4\u30e0\u30e9\u30a4\u30f3"}n+=" - "+d,a=r?r+"\u306e"+n:n,$("title").text(a)}function getTimelineOwnerName(){return($(':hidden[name="timeline-owner-name"]').val()||"Hey!")+"(@"+($(':hidden[name="timeline-owner-screen-name"]').val()||"Hoo!")+")"}function convertDateToJapanese(t){if(!t||"notSpecified"==t)return!1;var e="";return t.split(/-/).forEach(function(t,a){switch(a){case 0:e+=t+"\u5e74";break;case 1:e+=t+"\u6708";break;case 2:e+=t+"\u65e5"}}),e}function getUserAgent(){var t=window.navigator.userAgent.toLowerCase();return-1!=t.indexOf("opera")?"opera":-1!=t.indexOf("msie")?"ie":-1!=t.indexOf("chrome")?"chrome":-1!=t.indexOf("safari")?"safari":-1!=t.indexOf("firefox")&&"firefox"}function getCsrfToken(){return $("meta[name=csrf-token]").attr("content")}function scrollToPageTop(t){return t&&t.preventDefault(),$("html, body").animate({scrollTop:0},{easing:"swing",duration:500}),!1}function scrollDownToDestination(t,e){return t.preventDefault(),e-=160,$("html, body").animate({scrollTop:e},{easing:"swing",duration:500}),!1}function showLoader(t){var e=typeof t;"string"==e?$(t).find(".loader").fadeIn():"object"==e&&t.find(".loader").fadeIn()}function hideLoader(t){var e=typeof t;"string"==e?$(t).find(".loader").fadeOut():"object"==e&&t.find(".loader").fadeOut()}function checkStatusUpdate(){var t=$("#wrap-setting-lower").find(".tweets");$.ajax({url:"/ajax/check_status_update",type:"post",dataType:"json",success:function(e){e.do_update?updateStatus():($("#update-statuses").text("\u51e6\u7406\u7d42\u4e86"),t.find(".loader").fadeOut(),t.find(".additional-num").fadeOut(function(){$(this).addClass("alert alert-info").text("\u5909\u66f4\u306f\u3042\u308a\u307e\u305b\u3093")}).fadeIn(),t.find(".last-update .date").fadeOut(function(){$(this).text(e.checked_at)}).fadeIn())},error:function(){t.find(".additional-num").fadeOut(function(){$(this).addClass("alert alert-danger").text("\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044")}).fadeIn(),$("#update-statuses").text("\u30a8\u30e9\u30fc"),t.find(".loader").fadeOut()}})}function checkFriendUpdate(){var t,e,a,n=$("#wrap-setting-lower").find(".friends");$.ajax({url:"/ajax/check_friend_update",type:"post",dataType:"json",success:function(r){t=r.friends_count,e=r.updated,a=r.updated_date,e?(n.find(".count .total-num").fadeOut(function(){$(this).text(t)}).fadeIn(),n.find(".additional-num").fadeOut(function(){$(this).addClass("alert alert-success").text("\u66f4\u65b0\u3057\u307e\u3057\u305f")}).fadeIn(),$("#update-friends").text("\u66f4\u65b0\u5b8c\u4e86")):(n.find(".additional-num").fadeOut(function(){$(this).addClass("alert alert-info").text("\u5909\u66f4\u306f\u3042\u308a\u307e\u305b\u3093")}).fadeIn(),$("#update-friends").text("\u51e6\u7406\u7d42\u4e86")),n.find(".last-update .date").fadeOut(function(){$(this).text(a)}).fadeIn()},error:function(){n.find(".additional-num").fadeOut(function(){$(this).addClass("alert alert-danger").text("\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044")}).fadeIn(),$("#update-friends").text("\u30a8\u30e9\u30fc")},complete:function(){hideLoader(".friends")}})}function checkProfileUpdate(){var t,e,a=!1,n=$(".wrap-profile");$.ajax({url:"/ajax/check_profile_update",type:"post",dataType:"json",success:function(r){a=r.updated,t=r.updated_date,e=r.updated_value,a&&$.each(e,function(t,e){var a=t.split("_").join("-");$("."+a)[0]&&(-1!=a.indexOf("image")?($("."+a).fadeOut(function(){$(this).attr("src",e.replace("_normal","_reasonably_small"))}).fadeIn(),$("header").find(".twitter-profile img").fadeOut(function(){$(this).attr("src",e)}).fadeIn()):($("."+a).fadeOut(function(){$(this).text(e)}).fadeIn(),-1!=a.indexOf("screen-name")&&$("header").find(".twitter-profile a:last").fadeOut(function(){$(this).text("@"+e)}).fadeIn()))}),$(".updated-date").fadeOut(function(){$(this).text(t)}).fadeIn(),hideLoader(".wrap-profile");var i=a?"\u66f4\u65b0\u5b8c\u4e86":"\u51e6\u7406\u7d42\u4e86";$("#update-profile").text(i);var d=a?"alert-success":"alert-info",o=a?"\u66f4\u65b0\u3057\u307e\u3057\u305f":"\u5909\u66f4\u306f\u3042\u308a\u307e\u305b\u3093";n.find(".area-result .alert").addClass(d).text(o).fadeIn()},error:function(){n.find(".area-result .alert").addClass("alert-danger").text("\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044").fadeIn(),$("#update-profile").text("\u30a8\u30e9\u30fc"),hideLoader(".wrap-profile")}})}function updateStatus(){var t=$("#wrap-setting-lower").find(".tweets"),e=$("#update-statuses");$.ajax({url:"/ajax/update_status",type:"post",dataType:"json",data:{oldest_id_str:oldest_id_str},success:function(a){if(continue_process=a["continue"],updated_date=a.updated_date,continue_process)total_count+=a.saved_count,oldest_id_str=a.oldest_id_str,t.find(".additional-num").fadeOut(function(){$(this).text("+ "+total_count)}).fadeIn(),updateStatus();else{total_count+=a.saved_count;var n=0,r=parseInt($(".tweets").find(".count .total-num").text());n=r+parseInt(total_count),t.find(".total-num").fadeOut(function(){$(this).text(n).fadeIn()}),t.find(".additional-num").fadeOut(function(){$(this).addClass("alert alert-success").text(total_count+"\u4ef6\u8ffd\u52a0")}).fadeIn(),t.find(".last-update .date").fadeOut(function(){$(this).text(updated_date)}).fadeIn(),e.text("\u66f4\u65b0\u5b8c\u4e86")}},error:function(){t.find(".additional-num").fadeOut(function(){$(this).addClass("alert alert-danger").text("\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044")}).fadeIn(),e.text("\u30a8\u30e9\u30fc"),$(".loader").fadeOut()},complete:function(){continue_process||$(".loader").fadeOut()}})}function showDeleteCompleteMessage(t){var e="",a=$("#wrap-delete-account").find(".status");e=t?"\u30a2\u30ab\u30a6\u30f3\u30c8\u524a\u9664\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002<br/>\u81ea\u52d5\u7684\u306b\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002":"\u3059\u307f\u307e\u305b\u3093\uff01\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002<br/>\u753b\u9762\u3092\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002",a.fadeOut(function(){$(this).html(e)}).fadeIn()}function showDeleteErrorMessage(){return showCompleteMessage(!1)}function redirect(){location.href="/logout"}function getStatuses(t){var e,a=$(".wrap-progress-bar"),n=$(".wrap-tweet"),r=$("#start-import"),i="",d=t,o=$("input[name=count-so-far]").val();"false"!=o&&(total_imported_count=parseInt(o),$("input[name=count-so-far]").val("false")),$.ajax({url:"/ajax/acquire_statuses",type:"POST",dataType:"json",data:d,success:function(t){total_imported_count+=t.saved_count,i=t.noStatusAtAll,t["continue"]?($(".wrap-importing-status").fadeOut(function(){a.find(".total").html(total_imported_count+"\u4ef6"),n.find(".body").html(t.status.text),n.find(".date").html(t.status.date)}),d.id_str_oldest=t.id_str_oldest,e=getPersentage(total_imported_count),getStatuses(d)):0==total_imported_count?(r.text("...?"),a.find(".progress").fadeOut(function(){a.append('<div class="alert alert-info"><p>\u53d6\u5f97\u3067\u304d\u308b\u30c4\u30a4\u30fc\u30c8\u304c\u7121\u3044\u3088\u3046\u3067\u3059</p></div>'),a.find(".alert").fadeIn()})):(a.find(".bar").html("complete!"),e=100,r.addClass("disabled"),r.text(total_imported_count+"\u4ef6\u53d6\u5f97\u3057\u307e\u3057\u305f"),$(".progress").removeClass("active"),hideLoader("#wrap-import"))},error:function(){$(".progress").removeClass("active"),hideLoader("#wrap-import"),$(".wrap-progress-bar").fadeOut(function(){$(".wrap-lower").html('<div class="alert alert-warning"><p>\u30b5\u30fc\u30d0\u30fc\u304c\u6df7\u307f\u5408\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002<br/>\u3059\u307f\u307e\u305b\u3093\u304c\u3001\u3057\u3070\u3089\u304f\u3057\u3066\u304b\u3089\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002</p></div>'),$("#start-import").text("...oops")})},complete:function(){i?hideLoader("#wrap-import"):(setProgress(e),$(".wrap-importing-status").fadeIn()),100==e&&setTimeout(function(){location.href="/your/tweets"},2e3)}})}function getPersentage(t){t=parseInt(t);var e=parseInt($("#statuses-count").val()),a="";return a=t>3200?t/3200*100:t/e*100,parseInt(a)}function setProgress(t){$(".progress").find(".bar").css("width",t+"%")}function ajaxSwitchDashbord(t){var e=$("#wrap-dashbord"),a=$("#wrap-term-selectors");$.ajax({url:"/ajax/switch_dashbord",type:"post",dataType:"html",data:{action_type:t},success:function(n){a.html(n),e.attr("data-type",t)},error:function(){alert("\u30da\u30fc\u30b8\u306e\u8aad\u307f\u8fbc\u307f\u304c\u3046\u307e\u304f\u3044\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u307f\u3066\u4e0b\u3055\u3044\u3002")}})}function getDashbordType(){var t=$("#wrap-dashbord").data("type");return t||!1}function ajaxSwitchTerm(t,e,a){if(t&&e&&e&&a){var n=$("#wrap-timeline");n.html('<div class="cover"><span>Loading</span></div>');var r=n.find(".cover");r.css("height",200),r.animate({opacity:.8},200),$.ajax({type:"GET",dataType:"html",url:"/ajax/switch_term?ajax=true",data:{date:t,date_type:detectDateType(t),action_type:e},success:function(t){$("#wrap-main").html(t)},error:function(){alert("\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u753b\u9762\u3092\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044")},complete:function(){scrollToPageTop(),$("#wrap-main").fadeIn("fast"),$("#wrap-term-selectors").find("a").button("complete"),"click"==a&&window.history.pushState(null,null,href),updatePageTitleForTimeline(t,e)}})}else alert("required params not supplied")}function countStr(t,e){for(var a,n=0,r=0;-1!=(a=t.indexOf(e,r));)n++,r=a+1;return n}function detectDate(t){var e=t.lastIndexOf("/");return-1!=e&&t.substring(e+1)}function detectDateType(t){var e="-";return-1==t.indexOf(e)?t.length>=4&&"year":t.indexOf(e)==t.lastIndexOf(e)?"month":"day"}function detectActionType(t){var e=t.indexOf("/");if(-1==e)return!1;if(-1!=t.indexOf("public_timeline"))return"public_timeline";var a=t.indexOf("/",e+1);if(-1==a)return!1;var n=t.indexOf("/",a+1);if(-1==n)return t.substr(a+1);var r=n-a;return t.substr(a+1,r-1)}var total_count=0,oldest_id_str="",continue_process="",updated_date="",total_imported_count=0;